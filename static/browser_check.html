<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµè§ˆå™¨å…¼å®¹æ€§æ£€æµ‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .content {
            padding: 30px;
        }

        .check-section {
            margin-bottom: 30px;
        }

        .check-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .check-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #ccc;
        }

        .check-item.supported {
            border-left-color: #28a745;
            background: #d4edda;
        }

        .check-item.not-supported {
            border-left-color: #dc3545;
            background: #f8d7da;
        }

        .check-icon {
            font-size: 1.5em;
            margin-right: 15px;
            width: 30px;
            text-align: center;
        }

        .check-label {
            flex: 1;
            font-weight: 500;
        }

        .check-value {
            color: #666;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            word-break: break-all;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .info-box h4 {
            color: #1976D2;
            margin-bottom: 10px;
        }

        .info-box ul {
            margin-left: 20px;
        }

        .info-box li {
            margin: 5px 0;
            color: #555;
        }

        .recommendation {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .recommendation h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        .recommendation p {
            color: #666;
            line-height: 1.6;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }

        .action-button {
            display: block;
            padding: 15px;
            text-align: center;
            text-decoration: none;
            color: white;
            border-radius: 10px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .action-button.primary {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .action-button.secondary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        @media (max-width: 600px) {
            .action-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ” æµè§ˆå™¨å…¼å®¹æ€§æ£€æµ‹</h1>
            <p>æ£€æµ‹æ‚¨çš„æµè§ˆå™¨æ˜¯å¦æ”¯æŒæ‘„åƒå¤´åŠŸèƒ½</p>
        </header>

        <div class="content">
            <div class="check-section">
                <h3>ğŸ“± åŸºæœ¬ä¿¡æ¯</h3>
                <div id="basicInfo"></div>
            </div>

            <div class="check-section">
                <h3>ğŸ¥ æ‘„åƒå¤´ API æ”¯æŒ</h3>
                <div id="cameraSupport"></div>
            </div>

            <div class="check-section">
                <h3>ğŸŒ å…¶ä»– API æ”¯æŒ</h3>
                <div id="otherSupport"></div>
            </div>

            <div id="recommendation"></div>

            <div class="action-buttons" id="actionButtons"></div>
        </div>
    </div>

    <script>
        // æ£€æµ‹é¡¹
        const checks = {
            basic: [],
            camera: [],
            other: []
        };

        // åŸºæœ¬ä¿¡æ¯
        checks.basic.push({
            label: 'æµè§ˆå™¨',
            value: navigator.userAgent,
            supported: true
        });

        checks.basic.push({
            label: 'å¹³å°',
            value: navigator.platform || 'Unknown',
            supported: true
        });

        checks.basic.push({
            label: 'è¯­è¨€',
            value: navigator.language || 'Unknown',
            supported: true
        });

        checks.basic.push({
            label: 'åœ¨çº¿çŠ¶æ€',
            value: navigator.onLine ? 'åœ¨çº¿' : 'ç¦»çº¿',
            supported: navigator.onLine
        });

        checks.basic.push({
            label: 'å®‰å…¨ä¸Šä¸‹æ–‡ (Secure Context)',
            value: window.isSecureContext ? 'æ˜¯ (HTTPS/localhost/å±€åŸŸç½‘)' : 'å¦ (HTTP)',
            supported: window.isSecureContext
        });

        // æ‘„åƒå¤´æ”¯æŒ
        checks.camera.push({
            label: 'navigator å¯¹è±¡',
            value: typeof navigator !== 'undefined' ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨',
            supported: typeof navigator !== 'undefined'
        });

        checks.camera.push({
            label: 'navigator.mediaDevices',
            value: navigator.mediaDevices ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨',
            supported: !!navigator.mediaDevices
        });

        if (navigator.mediaDevices) {
            checks.camera.push({
                label: 'getUserMedia æ–¹æ³•',
                value: navigator.mediaDevices.getUserMedia ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨',
                supported: !!navigator.mediaDevices.getUserMedia
            });

            checks.camera.push({
                label: 'enumerateDevices æ–¹æ³•',
                value: navigator.mediaDevices.enumerateDevices ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨',
                supported: !!navigator.mediaDevices.enumerateDevices
            });
        } else {
            checks.camera.push({
                label: 'getUserMedia æ–¹æ³•',
                value: 'ä¸å­˜åœ¨ (mediaDevices ä¸å¯ç”¨)',
                supported: false
            });
        }

        // æ—§ç‰ˆ API æ£€æŸ¥
        const hasLegacyGetUserMedia = !!(
            navigator.getUserMedia ||
            navigator.webkitGetUserMedia ||
            navigator.mozGetUserMedia ||
            navigator.msGetUserMedia
        );

        checks.camera.push({
            label: 'æ—§ç‰ˆ getUserMedia',
            value: hasLegacyGetUserMedia ? 'å­˜åœ¨ (ä½†å·²åºŸå¼ƒ)' : 'ä¸å­˜åœ¨',
            supported: hasLegacyGetUserMedia
        });

        // å…¶ä»– API
        checks.other.push({
            label: 'File API',
            value: typeof FileReader !== 'undefined' ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ',
            supported: typeof FileReader !== 'undefined'
        });

        checks.other.push({
            label: 'FormData API',
            value: typeof FormData !== 'undefined' ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ',
            supported: typeof FormData !== 'undefined'
        });

        checks.other.push({
            label: 'Fetch API',
            value: typeof fetch !== 'undefined' ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ',
            supported: typeof fetch !== 'undefined'
        });

        checks.other.push({
            label: 'Canvas API',
            value: document.createElement('canvas').getContext ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ',
            supported: !!document.createElement('canvas').getContext
        });

        checks.other.push({
            label: 'Blob API',
            value: typeof Blob !== 'undefined' ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ',
            supported: typeof Blob !== 'undefined'
        });

        // æ¸²æŸ“æ£€æµ‹ç»“æœ
        function renderChecks(container, items) {
            const div = document.getElementById(container);
            items.forEach(item => {
                const checkItem = document.createElement('div');
                checkItem.className = `check-item ${item.supported ? 'supported' : 'not-supported'}`;

                const icon = item.supported ? 'âœ…' : 'âŒ';

                checkItem.innerHTML = `
                    <div class="check-icon">${icon}</div>
                    <div style="flex: 1;">
                        <div class="check-label">${item.label}</div>
                        <div class="check-value">${item.value}</div>
                    </div>
                `;

                div.appendChild(checkItem);
            });
        }

        // ç”Ÿæˆå»ºè®®
        function generateRecommendation() {
            const hasMediaDevices = !!navigator.mediaDevices;
            const hasGetUserMedia = !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia);
            const hasFileAPI = typeof FileReader !== 'undefined';
            const isSecure = window.isSecureContext;

            const recommendationDiv = document.getElementById('recommendation');
            const actionButtonsDiv = document.getElementById('actionButtons');

            if (hasGetUserMedia && isSecure) {
                // å®Œå…¨æ”¯æŒ WebRTC
                recommendationDiv.innerHTML = `
                    <div class="info-box">
                        <h4>ğŸ‰ å¤ªå¥½äº†ï¼æ‚¨çš„æµè§ˆå™¨å®Œå…¨æ”¯æŒæ‘„åƒå¤´åŠŸèƒ½ï¼</h4>
                        <p>æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»»ä½•ä¸€ç§æ–¹å¼ï¼š</p>
                        <ul>
                            <li><strong>WebRTC å®æ—¶æ‘„åƒå¤´</strong>ï¼šæ”¯æŒå®æ—¶é¢„è§ˆå’Œæ‹ç…§</li>
                            <li><strong>ç³»ç»Ÿç›¸æœºè°ƒç”¨</strong>ï¼šç›´æ¥ä½¿ç”¨ç³»ç»Ÿç›¸æœºåº”ç”¨</li>
                            <li><strong>å›¾ç‰‡ä¸Šä¼ </strong>ï¼šä¸Šä¼ å·²æœ‰ç…§ç‰‡</li>
                        </ul>
                    </div>
                `;

                actionButtonsDiv.innerHTML = `
                    <a href="camera_capture.html" class="action-button primary">
                        ğŸ¥ ä½¿ç”¨ WebRTC æ‘„åƒå¤´
                    </a>
                    <a href="camera_mobile_capture.html" class="action-button secondary">
                        ğŸ“¸ ä½¿ç”¨ç³»ç»Ÿç›¸æœº
                    </a>
                `;

            } else if (!hasMediaDevices || !hasGetUserMedia) {
                // ä¸æ”¯æŒ WebRTC
                recommendationDiv.innerHTML = `
                    <div class="recommendation">
                        <h4>âš ï¸ æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ WebRTC æ‘„åƒå¤´åŠŸèƒ½</h4>
                        <p><strong>åŸå› åˆ†æï¼š</strong></p>
                        <ul>
                            <li>æµè§ˆå™¨ç‰ˆæœ¬å¯èƒ½è¿‡æ—§ï¼ˆéœ€è¦ Chrome 53+, Firefox 36+, Safari 11+ï¼‰</li>
                            <li>æˆ–è€…æ˜¯ä¸æ”¯æŒ WebRTC çš„æµè§ˆå™¨ï¼ˆå¦‚ IEï¼‰</li>
                        </ul>
                        <p><strong>å»ºè®®æ–¹æ¡ˆï¼š</strong></p>
                        <ul>
                            <li>âœ… ä½¿ç”¨<strong>ç³»ç»Ÿç›¸æœºè°ƒç”¨æ–¹æ¡ˆ</strong>ï¼ˆæ¨èï¼Œå…¼å®¹æ€§æœ€å¥½ï¼‰</li>
                            <li>âœ… æˆ–è€…ç›´æ¥<strong>ä¸Šä¼ å›¾ç‰‡</strong></li>
                            <li>âš ï¸ æˆ–è€…æ›´æ–°/æ›´æ¢æµè§ˆå™¨ï¼ˆChromeã€Edgeã€Firefoxï¼‰</li>
                        </ul>
                    </div>
                `;

                actionButtonsDiv.innerHTML = `
                    <a href="camera_mobile_capture.html" class="action-button primary">
                        ğŸ“¸ ä½¿ç”¨ç³»ç»Ÿç›¸æœºï¼ˆæ¨èï¼‰
                    </a>
                    <a href="simple_upload.html" class="action-button secondary">
                        ğŸ“¤ ä¸Šä¼ å›¾ç‰‡
                    </a>
                `;

            } else if (!isSecure) {
                // éå®‰å…¨ä¸Šä¸‹æ–‡
                recommendationDiv.innerHTML = `
                    <div class="recommendation">
                        <h4>âš ï¸ éå®‰å…¨ä¸Šä¸‹æ–‡ (Non-Secure Context)</h4>
                        <p>æ‚¨çš„æµè§ˆå™¨æ”¯æŒæ‘„åƒå¤´ APIï¼Œä½†å½“å‰é¡µé¢ä¸åœ¨å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ã€‚</p>
                        <p><strong>å¯èƒ½çš„åŸå› ï¼š</strong></p>
                        <ul>
                            <li>ä½¿ç”¨äº† HTTP åè®®ï¼ˆè€Œé HTTPSï¼‰</li>
                            <li>ä¸æ˜¯ localhost æˆ–å±€åŸŸç½‘åœ°å€</li>
                        </ul>
                        <p><strong>å»ºè®®æ–¹æ¡ˆï¼š</strong></p>
                        <ul>
                            <li>âœ… ä½¿ç”¨<strong>ç³»ç»Ÿç›¸æœºè°ƒç”¨æ–¹æ¡ˆ</strong>ï¼ˆä¸å—å®‰å…¨ä¸Šä¸‹æ–‡é™åˆ¶ï¼‰</li>
                            <li>âš ï¸ æˆ–è€…é…ç½® HTTPS</li>
                        </ul>
                    </div>
                `;

                actionButtonsDiv.innerHTML = `
                    <a href="camera_mobile_capture.html" class="action-button primary">
                        ğŸ“¸ ä½¿ç”¨ç³»ç»Ÿç›¸æœº
                    </a>
                    <a href="simple_upload.html" class="action-button secondary">
                        ğŸ“¤ ä¸Šä¼ å›¾ç‰‡
                    </a>
                `;
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œæ£€æµ‹
        window.addEventListener('DOMContentLoaded', () => {
            renderChecks('basicInfo', checks.basic);
            renderChecks('cameraSupport', checks.camera);
            renderChecks('otherSupport', checks.other);
            generateRecommendation();

            console.log('=== æµè§ˆå™¨æ£€æµ‹ç»“æœ ===');
            console.log('User Agent:', navigator.userAgent);
            console.log('mediaDevices:', navigator.mediaDevices);
            console.log('isSecureContext:', window.isSecureContext);
        });
    </script>
</body>
</html>
