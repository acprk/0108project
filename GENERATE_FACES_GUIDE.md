# 生成1000个AI人脸 - 使用指南

## 快速开始

### 步骤 1: 运行生成脚本

```bash
cd /home/luck/xzy/0108project
venv/bin/python generate_real_faces.py
```

### 步骤 2: 选择生成数量

脚本会询问你要生成多少个人脸：

```
请输入要生成的数量 (1-1000，推荐先测试50):
```

**建议：**
- 首次测试：输入 `50`
- 正式使用：输入 `1000`

### 步骤 3: 等待生成完成

脚本会显示实时进度：

```
[1/50] 生成: 王伟... ✓
[2/50] 生成: 李娜... ✓
[3/50] 生成: 张明... ✓
...
进度: 10/50 | 成功: 10 | 失败: 0 | 预计剩余: 2.5分钟
```

### 步骤 4: 重启服务

生成完成后，重启服务加载新人脸：

```bash
pkill -f 'python main.py'
venv/bin/python main.py &
```

### 步骤 5: 验证

检查已加载的人脸数量：

```bash
curl http://localhost:8000/api/known_faces
```

应该显示：
```json
{
    "success": true,
    "known_faces": ["小徐", "王伟", "李娜", ...],
    "total": 51
}
```

---

## 数据源说明

### ThisPersonDoesNotExist.com

- **技术**: StyleGAN AI生成
- **特点**: 每张人脸都是AI创造的，**不是真实的人**
- **质量**: 高清、真实感强
- **识别率**: 可以被 face_recognition 库识别

### 为什么使用AI生成的人脸？

1. **隐私保护**: 不涉及真实人物
2. **版权无忧**: AI生成，可自由使用
3. **质量保证**: 专业的人脸生成算法
4. **多样性**: 每张人脸都独一无二

---

## 时间和性能

### 生成时间

| 数量 | 预计时间 | 磁盘空间 |
|------|----------|----------|
| 50   | 3-5 分钟 | ~20 MB   |
| 100  | 8-10 分钟| ~40 MB   |
| 500  | 30-40 分钟| ~200 MB |
| 1000 | 60-90 分钟| ~400 MB |

### 识别性能

| 人脸数量 | 识别速度 | 内存占用 |
|----------|----------|----------|
| 1-10     | < 100ms  | ~100 MB  |
| 50       | < 300ms  | ~300 MB  |
| 100      | < 500ms  | ~500 MB  |
| 500      | 1-2s     | ~2 GB    |
| 1000     | 2-5s     | ~4 GB    |

**注意**: 人脸数量越多，识别速度越慢。

---

## 生成的人脸特征

每个人脸会自动分配：

### 1. 随机中文姓名

使用100个常见姓氏和70+个常见名字组合：
- 王伟、李娜、张明、刘芳...
- 自动避免重名

### 2. 高质量图片

- **格式**: JPEG
- **尺寸**: 400x400 像素
- **质量**: 90%（高清）

### 3. 人脸特征向量

- **维度**: 128维
- **算法**: dlib face recognition
- **用途**: 用于识别和比对

---

## 常见问题

### Q: 下载失败怎么办？

**A**: 脚本会自动重试3次。如果仍然失败：
- 检查网络连接
- 确认可以访问 thispersondoesnotexist.com
- 稍后重试

### Q: 可以中途停止吗？

**A**: 可以。按 Ctrl+C 停止，已下载的人脸会保留。

### Q: 如何删除生成的人脸？

**A**: 删除对应的 .jpg 文件：

```bash
# 删除所有人脸（保留小徐）
cd models/known_faces
rm -f !(小徐.jpg)

# 或删除全部
rm -f *.jpg
```

### Q: 可以添加更多人脸吗？

**A**: 可以。再次运行脚本，选择不清理现有文件。

### Q: 识别速度太慢怎么办？

**A**:
1. 减少人脸数量（如只保留100个）
2. 使用更快的硬件
3. 优化代码（使用索引、缓存等）

---

## 进阶使用

### 批量生成特定数量

直接在脚本中修改，跳过交互：

```python
# 在 generate_real_faces.py 中修改
target_count = 1000  # 直接设置数量
```

### 自定义名字列表

编辑 `SURNAMES` 和 `GIVEN_NAMES` 列表。

### 调整图片质量

修改保存部分：

```python
image.save(save_path, 'JPEG', quality=95)  # 提高质量
```

---

## 测试建议

### 1. 小规模测试 (50个)

```bash
venv/bin/python generate_real_faces.py
# 输入: 50
```

验证：
- 图片能否正常识别
- 识别速度是否可接受
- 内存占用是否正常

### 2. 中等规模 (100-200个)

适合演示和开发测试。

### 3. 大规模 (1000个)

适合压力测试和性能评估。

---

## 故障排除

### 网络问题

```bash
# 测试网络连接
curl -I https://thispersondoesnotexist.com/

# 如果无法访问，检查代理设置
export http_proxy=http://your-proxy:port
export https_proxy=http://your-proxy:port
```

### 内存不足

生成大量人脸时可能需要较多内存：

```bash
# 检查内存
free -h

# 如果不足，减少生成数量
```

### 磁盘空间不足

```bash
# 检查磁盘空间
df -h

# 1000个人脸约需400MB空间
```

---

## 下一步

生成完成后：

1. **重启服务**
   ```bash
   pkill -f 'python main.py'
   venv/bin/python main.py &
   ```

2. **测试识别**
   - 访问 http://localhost:8000
   - 使用"图片上传"功能
   - 上传不同的人脸照片测试

3. **性能测试**
   - 测试识别速度
   - 测试准确率
   - 观察内存占用

---

**开始生成吧！** 🚀
